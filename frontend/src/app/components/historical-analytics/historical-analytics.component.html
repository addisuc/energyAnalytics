<div class="historical-analytics-container">
  <div class="analytics-header">
    <h1 class="page-title">Historical Analytics</h1>
    <p class="page-subtitle">Analyze long-term energy trends and performance patterns</p>
  </div>

  <!-- Controls -->
  <div class="controls-section">
    <div class="control-group">
      <label for="region-select">Region:</label>
      <select id="region-select" [(ngModel)]="selectedRegion" (change)="onRegionChange(selectedRegion)">
        <option *ngFor="let region of regions" [value]="region.value">{{ region.label }}</option>
      </select>
    </div>
    
    <div class="control-group">
      <label for="period-select">Time Period:</label>
      <select id="period-select" [(ngModel)]="selectedPeriod" (change)="onPeriodChange(selectedPeriod)">
        <option *ngFor="let period of periods" [value]="period.value">{{ period.label }}</option>
      </select>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading historical data...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-container">
    <div class="error-icon">
      <i class="material-icons">error_outline</i>
    </div>
    <h3>Unable to Load Historical Data</h3>
    <p>{{ error }}</p>
    <button class="retry-button" (click)="loadHistoricalData()">
      <i class="material-icons">refresh</i>
      Try Again
    </button>
  </div>

  <!-- Historical Data Display -->
  <div *ngIf="historicalData && !isLoading" class="analytics-grid">
    <!-- Summary Cards -->
    <div class="summary-cards">
      <div class="summary-card">
        <div class="card-icon">
          <i class="material-icons">assessment</i>
        </div>
        <div class="card-content">
          <h3>Total Records</h3>
          <div class="card-value">{{ historicalData.totalRecords | number }}</div>
          <div class="card-subtitle">Data points collected</div>
        </div>
      </div>

      <div class="summary-card">
        <div class="card-icon">
          <i class="material-icons">speed</i>
        </div>
        <div class="card-content">
          <h3>Average Efficiency</h3>
          <div class="card-value">{{ historicalData.averageEfficiency | number:'1.1-1' }}%</div>
          <div class="card-subtitle">Energy efficiency</div>
        </div>
      </div>

      <div class="summary-card">
        <div class="card-icon">
          <i class="material-icons">flash_on</i>
        </div>
        <div class="card-content">
          <h3>Peak Generation</h3>
          <div class="card-value">{{ historicalData.peakGeneration | number:'1.0-0' }} MW</div>
          <div class="card-subtitle">Maximum output</div>
        </div>
      </div>
    </div>

    <!-- Trends Analysis -->
    <div class="trends-section">
      <h2 class="section-title">Performance Trends</h2>
      <div class="trends-grid">
        <div class="trend-item">
          <div class="trend-header">
            <i class="material-icons" [class]="getTrendColor(historicalData.trends?.efficiency)">
              {{ getTrendIcon(historicalData.trends?.efficiency) }}
            </i>
            <span class="trend-label">Efficiency Trend</span>
          </div>
          <div class="trend-value" [class]="getTrendColor(historicalData.trends?.efficiency)">
            {{ historicalData.trends?.efficiency | titlecase }}
          </div>
        </div>

        <div class="trend-item">
          <div class="trend-header">
            <i class="material-icons" [class]="getTrendColor(historicalData.trends?.generation)">
              {{ getTrendIcon(historicalData.trends?.generation) }}
            </i>
            <span class="trend-label">Generation Trend</span>
          </div>
          <div class="trend-value" [class]="getTrendColor(historicalData.trends?.generation)">
            {{ historicalData.trends?.generation | titlecase }}
          </div>
        </div>

        <div class="trend-item">
          <div class="trend-header">
            <i class="material-icons" [class]="getTrendColor(historicalData.trends?.consumption)">
              {{ getTrendIcon(historicalData.trends?.consumption) }}
            </i>
            <span class="trend-label">Consumption Trend</span>
          </div>
          <div class="trend-value" [class]="getTrendColor(historicalData.trends?.consumption)">
            {{ historicalData.trends?.consumption | titlecase }}
          </div>
        </div>
      </div>
    </div>

    <!-- Analysis Period Info -->
    <div class="period-info">
      <div class="info-card">
        <h3>Analysis Period</h3>
        <p><strong>Region:</strong> {{ selectedRegion | titlecase }} Region</p>
        <p><strong>Period:</strong> {{ historicalData.period }}</p>
        <p><strong>Data Coverage:</strong> {{ historicalData.totalRecords }} data points</p>
      </div>
    </div>
  </div>
</div>